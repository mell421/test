---
title: "ugo"
output:
  html_document:
    df_print: paged
    toc: false
---
```{r setup, include = FALSE}
suppressWarnings(source("./R/sources.R"))
library("tm")
library(textstem)

delayW <- 5
myRemoveListU <- c("les", "la")
myToSpaceListU <- c("@","\\|","'<'","\\'","/")
toSpace <- content_transformer(function (x , pattern ) gsub(pattern, " ", x))
removeAccentE <- content_transformer(function (x , pattern ) gsub(pattern, "e", x))
removeAccentA <- content_transformer(function (x , pattern ) gsub(pattern, "a", x))
removeC <- content_transformer(function (x , pattern ) gsub(pattern, "c", x))
removeSpace <- content_transformer(function (x , pattern ) gsub(pattern, "", x))

wcLemme <- function(text){
  TextDoc <- Corpus(VectorSource(text))
  TextDoc <- tm_map(TextDoc, toSpace, myToSpaceListU)
  TextDoc <- tm_map(TextDoc, content_transformer(tolower))
  TextDoc <- tm_map(TextDoc, removeWords, myRemoveListU)
  TextDoc <- tm_map(TextDoc, removeNumbers)
  TextDoc <- tm_map(TextDoc, removePunctuation)
  TextDoc <- tm_map(TextDoc, stripWhitespace)
  TextDoc <- tm_map(TextDoc, removeNumbers)
  TextDoc <- tm_map(TextDoc, removeWords, stopwords("french"))
  #TextDoc <- tm_map(TextDoc, lemmatize_strings())
  
  TextDoc <- tm_map(TextDoc,lemmatize_words)
  TextDoc <- tm_map(TextDoc, stemDocument)


  # Build a term-document matrix
  TextDoc_dtm <- TermDocumentMatrix(TextDoc)
  dtm_m <- as.matrix(TextDoc_dtm)
  # Sort by descearing value of frequency
  dtm_v <- sort(rowSums(dtm_m),decreasing=TRUE)
  dtm_d <- data.frame(word = names(dtm_v),freq=dtm_v)

  Zipf_plot(TextDoc_dtm)
  print("Zipf")



  return(dtm_d)
}
```

---

```{r a1 , echo=FALSE}
# Give the input file name to the function.
CommPos <- read.csv(file = "dfCommPos.csv")
dfCommPos <- data.frame(CommPos)
dfCommPos
#print(dfCommPos)

CommNeu <- read.csv(file = "dfCommNeu.csv")
dfCommNeu <- data.frame(CommNeu)
dfCommNeu
#print(dfCommNeu)

CommNeg <- read.csv(file = "dfCommNeg.csv")
dfCommNeg <- data.frame(CommNeg)
dfCommNeg

CommAll <- read.csv(file = "ugoComments.csv")
dfCommAll <- data.frame(CommAll)
dfCommAll
```

```{r a2 , echo=FALSE}

```
### all
```{r all1, echo=FALSE}
text <- dfCommAll$tradFr

tm <- function(text){
  dtm_d <- wc(text)
  # Display the top 20 most frequent words
  head(dtm_d, 30)

  # Plot the most frequent words
  barplotSimple(dtm_d[1:20,]$freq,dtm_d[1:20,]$word,"Top 20 recent")
  
  #generate word cloud
  wcSimple(dtm_d$word,dtm_d$freq)
  wcDouble(dtm_d,"circle","UgoAll.png",delayW)

}

suppressWarnings(tm(text))

tm <- function(text){
  dtm_d <- wcLemme(text)
  # Display the top 20 most frequent words
  head(dtm_d, 30)

  # Plot the most frequent words
  barplotSimple(dtm_d[1:20,]$freq,dtm_d[1:20,]$word,"Top 20 recent")
  
  #generate word cloud
  wcSimple(dtm_d$word,dtm_d$freq)
  wcDouble(dtm_d,"circle","UgoAll.png",delayW)

}

suppressWarnings(tm(text))
```

### pos
```{r pos1, echo=FALSE}
text <- data.frame(dfCommPos$tradFr)

tm <- function(text){
  dtm_d <- wc(text)
  # Display the top 20 most frequent words
  head(dtm_d, 30)

  # Plot the most frequent words
  barplotSimple(dtm_d[1:20,]$freq,dtm_d[1:20,]$word,"Top 20 recent")
  
  #generate word cloud
  wcSimple(dtm_d$word,dtm_d$freq)
  wcDouble(dtm_d,"circle","UgoPos.png",delayW)

}

suppressWarnings(tm(text))
tm <- function(text){
  dtm_d <- wcLemme(text)
  # Display the top 20 most frequent words
  head(dtm_d, 30)

  # Plot the most frequent words
  barplotSimple(dtm_d[1:20,]$freq,dtm_d[1:20,]$word,"Top 20 recent")
  
  #generate word cloud
  wcSimple(dtm_d$word,dtm_d$freq)
  wcDouble(dtm_d,"circle","UgoPos.png",delayW)

}

suppressWarnings(tm(text))
```

### neu
```{r neu1, echo=FALSE}
text <- data.frame(dfCommNeu$tradFr)

tm <- function(text){
  dtm_d <- wc(text)
  # Display the top 20 most frequent words
  head(dtm_d, 30)

  # Plot the most frequent words
  barplotSimple(dtm_d[1:20,]$freq,dtm_d[1:20,]$word,"Top 20 recent")
  
  #generate word cloud
  wcSimple(dtm_d$word,dtm_d$freq)
  wcDouble(dtm_d,"circle","UgoNeu.png",delayW)

}

suppressWarnings(tm(text))
tm <- function(text){
  dtm_d <- wcLemme(text)
  # Display the top 20 most frequent words
  head(dtm_d, 30)

  # Plot the most frequent words
  barplotSimple(dtm_d[1:20,]$freq,dtm_d[1:20,]$word,"Top 20 recent")
  
  #generate word cloud
  wcSimple(dtm_d$word,dtm_d$freq)
  wcDouble(dtm_d,"circle","UgoNeu.png",delayW)

}

suppressWarnings(tm(text))
```


### neg
```{r neg1, echo=FALSE}
text <- data.frame(dfCommNeg$tradFr)

tm <- function(text){
  dtm_d <- wc(text)
  # Display the top 20 most frequent words
  head(dtm_d, 30)

  # Plot the most frequent words
  barplotSimple(dtm_d[1:20,]$freq,dtm_d[1:20,]$word,"Top 20 recent")
  
  #generate word cloud
  wcSimple(dtm_d$word,dtm_d$freq)
  wcDouble(dtm_d,"circle","UgoNeg.png",delayW)

}

suppressWarnings(tm(text))
tm <- function(text){
  dtm_d <- wcLemme(text)
  # Display the top 20 most frequent words
  head(dtm_d, 30)

  # Plot the most frequent words
  barplotSimple(dtm_d[1:20,]$freq,dtm_d[1:20,]$word,"Top 20 recent")
  
  #generate word cloud
  wcSimple(dtm_d$word,dtm_d$freq)
  wcDouble(dtm_d,"circle","UgoNeg.png",delayW)

}

suppressWarnings(tm(text))
```






